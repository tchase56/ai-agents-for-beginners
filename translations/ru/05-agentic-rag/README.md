<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "d2f04b783b9e1253100329afd698f8ff",
  "translation_date": "2025-08-29T12:29:00+00:00",
  "source_file": "05-agentic-rag/README.md",
  "language_code": "ru"
}
-->
[![Agentic RAG](../../../translated_images/lesson-5-thumbnail.20ba9d0c0ae64fae06637eb2023395d437b0152c0463c2227ff456afe5f14644.ru.png)](https://youtu.be/WcjAARvdL7I?si=BCgwjwFb2yCkEhR9)

> _(Нажмите на изображение выше, чтобы посмотреть видео этого урока)_

# Agentic RAG

Этот урок предоставляет всесторонний обзор Agentic Retrieval-Augmented Generation (Agentic RAG) — нового подхода в области искусственного интеллекта, где крупные языковые модели (LLMs) автономно планируют свои дальнейшие шаги, извлекая информацию из внешних источников. В отличие от статических моделей «извлечь, затем прочитать», Agentic RAG включает итеративные вызовы LLM, чередующиеся с использованием инструментов или функций и структурированных выводов. Система оценивает результаты, уточняет запросы, при необходимости вызывает дополнительные инструменты и продолжает этот цикл до достижения удовлетворительного решения.

## Введение

В этом уроке вы узнаете:

- **Понять Agentic RAG:** Узнайте о новом подходе в области искусственного интеллекта, где крупные языковые модели (LLMs) автономно планируют свои дальнейшие шаги, извлекая информацию из внешних источников данных.
- **Освоить итеративный стиль Maker-Checker:** Поймите цикл итеративных вызовов LLM, чередующихся с использованием инструментов или функций и структурированных выводов, разработанный для повышения точности и обработки некорректных запросов.
- **Изучить практические применения:** Определите сценарии, где Agentic RAG особенно полезен, например, в средах с приоритетом точности, сложных взаимодействиях с базами данных и расширенных рабочих процессах.

## Цели обучения

После завершения этого урока вы будете знать/понимать:

- **Понимание Agentic RAG:** Узнайте о новом подходе в области искусственного интеллекта, где крупные языковые модели (LLMs) автономно планируют свои дальнейшие шаги, извлекая информацию из внешних источников данных.
- **Итеративный стиль Maker-Checker:** Освойте концепцию цикла итеративных вызовов LLM, чередующихся с использованием инструментов или функций и структурированных выводов, разработанную для повышения точности и обработки некорректных запросов.
- **Владение процессом рассуждений:** Поймите способность системы самостоятельно принимать решения о том, как подходить к задачам, без опоры на заранее определенные пути.
- **Рабочий процесс:** Узнайте, как агентная модель самостоятельно решает извлечь отчеты о рыночных тенденциях, определить данные о конкурентах, сопоставить внутренние метрики продаж, синтезировать выводы и оценить стратегию.
- **Итеративные циклы, интеграция инструментов и память:** Узнайте о зависимости системы от циклического взаимодействия, поддерживающего состояние и память на протяжении шагов, чтобы избежать повторяющихся циклов и принимать обоснованные решения.
- **Обработка режимов отказа и самокоррекция:** Изучите надежные механизмы самокоррекции системы, включая итерацию и повторные запросы, использование диагностических инструментов и обращение к человеческому контролю.
- **Границы агентности:** Поймите ограничения Agentic RAG, сосредоточив внимание на автономии в рамках конкретных доменов, зависимости от инфраструктуры и соблюдении ограничений.
- **Практические случаи использования и ценность:** Определите сценарии, где Agentic RAG особенно полезен, например, в средах с приоритетом точности, сложных взаимодействиях с базами данных и расширенных рабочих процессах.
- **Управление, прозрачность и доверие:** Узнайте о важности управления и прозрачности, включая объяснимые рассуждения, контроль предвзятости и человеческий контроль.

## Что такое Agentic RAG?

Agentic Retrieval-Augmented Generation (Agentic RAG) — это новый подход в области искусственного интеллекта, где крупные языковые модели (LLMs) автономно планируют свои дальнейшие шаги, извлекая информацию из внешних источников. В отличие от статических моделей «извлечь, затем прочитать», Agentic RAG включает итеративные вызовы LLM, чередующиеся с использованием инструментов или функций и структурированных выводов. Система оценивает результаты, уточняет запросы, при необходимости вызывает дополнительные инструменты и продолжает этот цикл до достижения удовлетворительного решения. Этот итеративный стиль «maker-checker» повышает точность, обрабатывает некорректные запросы и обеспечивает высокое качество результатов.

Система активно управляет процессом рассуждений, переписывает неудачные запросы, выбирает различные методы извлечения и интегрирует несколько инструментов — таких как векторный поиск в Azure AI Search, SQL-базы данных или пользовательские API — перед финализацией ответа. Отличительная черта агентной системы — способность самостоятельно управлять процессом рассуждений. Традиционные реализации RAG полагаются на заранее определенные пути, но агентная система автономно определяет последовательность шагов на основе качества найденной информации.

## Определение Agentic Retrieval-Augmented Generation (Agentic RAG)

Agentic Retrieval-Augmented Generation (Agentic RAG) — это новый подход в разработке искусственного интеллекта, где LLMs не только извлекают информацию из внешних источников данных, но и автономно планируют свои дальнейшие шаги. В отличие от статических моделей «извлечь, затем прочитать» или тщательно прописанных последовательностей подсказок, Agentic RAG включает цикл итеративных вызовов LLM, чередующихся с использованием инструментов или функций и структурированных выводов. На каждом этапе система оценивает полученные результаты, решает, нужно ли уточнить запросы, вызывает дополнительные инструменты при необходимости и продолжает этот цикл до достижения удовлетворительного решения.

Этот итеративный стиль «maker-checker» разработан для повышения точности, обработки некорректных запросов к структурированным базам данных (например, NL2SQL) и обеспечения сбалансированных, высококачественных результатов. Вместо того чтобы полагаться исключительно на тщательно разработанные цепочки подсказок, система активно управляет процессом рассуждений. Она может переписывать неудачные запросы, выбирать различные методы извлечения и интегрировать несколько инструментов — таких как векторный поиск в Azure AI Search, SQL-базы данных или пользовательские API — перед финализацией ответа. Это устраняет необходимость в чрезмерно сложных оркестрационных фреймворках. Вместо этого относительно простой цикл «вызов LLM → использование инструмента → вызов LLM → …» может привести к сложным и обоснованным выводам.

![Agentic RAG Core Loop](../../../translated_images/agentic-rag-core-loop.c8f4b85c26920f71ed181ebb14001ac7aae47c0b0af237edcf71898645a62db3.ru.png)

## Владение процессом рассуждений

Отличительная черта, которая делает систему «агентной», — это ее способность самостоятельно управлять процессом рассуждений. Традиционные реализации RAG часто зависят от заранее определенного человеком пути для модели: цепочки рассуждений, которая определяет, что извлекать и когда. Но когда система действительно агентная, она самостоятельно решает, как подходить к задаче. Она не просто выполняет сценарий; она автономно определяет последовательность шагов на основе качества найденной информации.

Например, если ее просят создать стратегию запуска продукта, она не полагается исключительно на подсказку, которая полностью описывает весь процесс исследования и принятия решений. Вместо этого агентная модель самостоятельно решает:

1. Извлечь текущие отчеты о рыночных тенденциях с помощью Bing Web Grounding.
2. Определить соответствующие данные о конкурентах с помощью Azure AI Search.
3. Сопоставить исторические внутренние метрики продаж с помощью Azure SQL Database.
4. Синтезировать выводы в согласованную стратегию, организованную через Azure OpenAI Service.
5. Оценить стратегию на наличие пробелов или несоответствий, инициируя еще один цикл извлечения при необходимости.

Все эти шаги — уточнение запросов, выбор источников, итерация до достижения «удовлетворительного» ответа — решаются моделью, а не заранее прописываются человеком.

## Итеративные циклы, интеграция инструментов и память

![Tool Integration Architecture](../../../translated_images/tool-integration.0f569710b5c17c106757adba082f6c4be025ca0721bff7d1ee4b929a3617a600.ru.png)

Агентная система опирается на циклический паттерн взаимодействия:

- **Первоначальный вызов:** Цель пользователя (т.е. запрос пользователя) представляется LLM.
- **Использование инструментов:** Если модель обнаруживает недостающую информацию или неоднозначные инструкции, она выбирает инструмент или метод извлечения — например, запрос к векторной базе данных (например, Azure AI Search Hybrid search по частным данным) или структурированный SQL-запрос — чтобы собрать больше контекста.
- **Оценка и уточнение:** После анализа возвращенных данных модель решает, достаточно ли информации. Если нет, она уточняет запрос, пробует другой инструмент или корректирует подход.
- **Повтор до удовлетворения:** Этот цикл продолжается до тех пор, пока модель не решит, что у нее достаточно ясности и доказательств для предоставления окончательного, хорошо обоснованного ответа.
- **Память и состояние:** Поскольку система поддерживает состояние и память на протяжении шагов, она может вспоминать предыдущие попытки и их результаты, избегая повторяющихся циклов и принимая более обоснованные решения по мере продвижения.

Со временем это создает ощущение развивающегося понимания, позволяя модели выполнять сложные, многоэтапные задачи без необходимости постоянного вмешательства человека или изменения запроса.

## Обработка режимов отказа и самокоррекция

Автономия Agentic RAG также включает надежные механизмы самокоррекции. Когда система сталкивается с тупиками — например, извлекает нерелевантные документы или сталкивается с некорректными запросами — она может:

- **Итерировать и повторно запрашивать:** Вместо того чтобы возвращать малоценные ответы, модель пробует новые стратегии поиска, переписывает запросы к базе данных или обращается к альтернативным наборам данных.
- **Использовать диагностические инструменты:** Система может вызывать дополнительные функции, предназначенные для помощи в отладке шагов рассуждений или подтверждения корректности извлеченных данных. Инструменты, такие как Azure AI Tracing, будут важны для обеспечения надежной наблюдаемости и мониторинга.
- **Обратиться к человеческому контролю:** В сценариях с высоким риском или при повторяющихся сбоях модель может сигнализировать о неопределенности и запросить руководство человека. После того как человек предоставит корректирующую обратную связь, модель сможет использовать этот урок в будущем.

Этот итеративный и динамичный подход позволяет модели постоянно улучшаться, гарантируя, что она не просто одноразовая система, а система, которая учится на своих ошибках в рамках текущей сессии.

![Self Correction Mechanism](../../../translated_images/self-correction.da87f3783b7f174bdc592c754b352884dd283814758bfeb7a68f5fd910272f3b.ru.png)

## Границы агентности

Несмотря на свою автономию в рамках задачи, Agentic RAG не является аналогом искусственного общего интеллекта. Ее «агентные» возможности ограничены инструментами, источниками данных и политиками, предоставленными разработчиками. Она не может изобретать собственные инструменты или выходить за пределы установленных границ. Вместо этого она превосходно справляется с динамической оркестрацией доступных ресурсов.

Ключевые отличия от более продвинутых форм ИИ включают:

1. **Автономия в рамках домена:** Системы Agentic RAG сосредоточены на достижении целей, определенных пользователем, в известной области, используя стратегии, такие как переписывание запросов или выбор инструментов, для улучшения результатов.
2. **Зависимость от инфраструктуры:** Возможности системы зависят от инструментов и данных, интегрированных разработчиками. Она не может превзойти эти границы без вмешательства человека.
3. **Соблюдение ограничений:** Этические принципы, правила соответствия и бизнес-политики остаются очень важными. Свобода агента всегда ограничена мерами безопасности и механизмами контроля (надеемся?).

## Практические случаи использования и ценность

Agentic RAG особенно полезен в сценариях, требующих итеративного уточнения и точности:

1. **Среды с приоритетом точности:** В проверке соответствия, анализе нормативных актов или юридических исследованиях агентная модель может многократно проверять факты, консультироваться с несколькими источниками и переписывать запросы до тех пор, пока не предоставит тщательно проверенный ответ.
2. **Сложные взаимодействия с базами данных:** При работе со структурированными данными, где запросы часто могут терпеть неудачу или требовать корректировки, система может автономно уточнять запросы, используя Azure SQL или Microsoft Fabric OneLake, гарантируя, что окончательное извлечение соответствует намерениям пользователя.
3. **Расширенные рабочие процессы:** Длительные сессии могут развиваться по мере появления новой информации. Agentic RAG может постоянно включать новые данные, изменяя стратегии по мере того, как она узнает больше о проблемной области.

## Управление, прозрачность и доверие

По мере того как эти системы становятся более автономными в своих рассуждениях, управление и прозрачность становятся критически важными:

- **Объяснимые рассуждения:** Модель может предоставить журнал запросов, которые она сделала, источников, которые она проконсультировала, и шагов рассуждений, которые она предприняла для достижения своего вывода. Инструменты, такие как Azure AI Content Safety и Azure AI Tracing / GenAIOps, могут помочь поддерживать прозрачность и снижать риски.
- **Контроль предвзятости и сбалансированное извлечение:** Разработчики могут настраивать стратегии извлечения, чтобы гарантировать учет сбалансированных, репрезентативных источников данных, и регулярно проверять выводы, чтобы выявлять предвзятость или искаженные шаблоны, используя пользовательские модели для продвинутых организаций в области анализа данных с помощью Azure Machine Learning.
- **Человеческий контроль и соответствие:** Для чувствительных задач человеческий контроль остается необходимым. Agentic RAG не заменяет человеческое суждение в решениях с высоким риском — она дополняет его, предоставляя более тщательно проверенные варианты.

Наличие инструментов, которые предоставляют четкий отчет о действиях, является важным. Без них отладка многоэтапного процесса может быть очень сложной. См. следующий пример от Literal AI (компания, стоящая за Chainlit) для выполнения агентом:

![AgentRunExample](../../../translated_images/AgentRunExample.471a94bc40cbdc0cd04c1f43c8d8c9b751f10d97918c900e29cb3ba0d6aa4c00.ru.png)

![AgentRunExample2](../../../translated_images/AgentRunExample2.19c7410a03bbc216c446b8a4e35ac82f1e8bc0ed313484212f5f4d1137637245.ru.png)

## Заключение

Agentic RAG представляет собой естественную эволюцию в том, как системы искусственного интеллекта справляются со сложными задачами, требующими интенсивной работы с данными. Используя циклический паттерн взаимодействия, автономно выбирая инструменты и уточняя запросы до достижения высококачественного результата, система выходит за рамки статического следования подсказкам, становясь более адаптивным и осведомленным о контексте решателем задач. Хотя она все еще ограничена инфраструктурой и этическими принципами, определенными человеком, эти агентные возможности позволяют создавать более богатые, динамичные и, в конечном итоге, более полезные взаимодействия с ИИ как для предприятий, так и для конечных пользователей.

### Остались вопросы о Agentic RAG?

Присоединяйтесь к [Azure AI Foundry Discord](https://aka.ms/ai-agents/discord), чтобы встретиться с другими учащимися, посетить офисные часы и получить ответы на свои вопросы о AI Agents.

## Дополнительные ресурсы

-
<a href="https://learn.microsoft.com/training/modules/use-own-data-azure-openai" target="_blank">
Реализация Retrieval Augmented Generation (RAG) с использованием Azure OpenAI Service: Узнайте, как использовать собственные данные с Azure OpenAI Service. Этот модуль Microsoft Learn предоставляет подробное руководство по реализации RAG  
- <a href="https://learn.microsoft.com/azure/ai-studio/concepts/evaluation-approach-gen-ai" target="_blank">Оценка приложений генеративного ИИ с Azure AI Foundry: В статье рассматривается оценка и сравнение моделей на общедоступных наборах данных, включая приложения Agentic AI и архитектуры RAG</a>  
- <a href="https://weaviate.io/blog/what-is-agentic-rag" target="_blank">Что такое Agentic RAG | Weaviate</a>  
- <a href="https://ragaboutit.com/agentic-rag-a-complete-guide-to-agent-based-retrieval-augmented-generation/" target="_blank">Agentic RAG: Полное руководство по агентно-ориентированному Retrieval Augmented Generation – Новости о RAG</a>  
- <a href="https://huggingface.co/learn/cookbook/agent_rag" target="_blank">Agentic RAG: ускорьте ваш RAG с помощью реформулировки запросов и самоанализа! Hugging Face Open-Source AI Cookbook</a>  
- <a href="https://youtu.be/aQ4yQXeB1Ss?si=2HUqBzHoeB5tR04U" target="_blank">Добавление агентных слоев в RAG</a>  
- <a href="https://www.youtube.com/watch?v=zeAyuLc_f3Q&t=244s" target="_blank">Будущее ассистентов знаний: Джерри Лю</a>  
- <a href="https://www.youtube.com/watch?v=AOSjiXP1jmQ" target="_blank">Как создавать системы Agentic RAG</a>  
- <a href="https://ignite.microsoft.com/sessions/BRK102?source=sessions" target="_blank">Использование Azure AI Foundry Agent Service для масштабирования ваших ИИ-агентов</a>  

### Научные статьи

- <a href="https://arxiv.org/abs/2303.17651" target="_blank">2303.17651 Self-Refine: Итеративное улучшение с самообратной связью</a>  
- <a href="https://arxiv.org/abs/2303.11366" target="_blank">2303.11366 Reflexion: Языковые агенты с вербальным обучением с подкреплением</a>  
- <a href="https://arxiv.org/abs/2305.11738" target="_blank">2305.11738 CRITIC: Большие языковые модели могут самокорректироваться с помощью инструментального критического анализа</a>  
- <a href="https://arxiv.org/abs/2501.09136" target="_blank">2501.09136 Agentic Retrieval-Augmented Generation: Обзор Agentic RAG</a>  

## Предыдущий урок

[Шаблон проектирования использования инструментов](../04-tool-use/README.md)  

## Следующий урок

[Создание надежных ИИ-агентов](../06-building-trustworthy-agents/README.md)  

---

**Отказ от ответственности**:  
Этот документ был переведен с использованием сервиса автоматического перевода [Co-op Translator](https://github.com/Azure/co-op-translator). Хотя мы стремимся к точности, пожалуйста, имейте в виду, что автоматические переводы могут содержать ошибки или неточности. Оригинальный документ на его исходном языке следует считать авторитетным источником. Для получения критически важной информации рекомендуется профессиональный перевод человеком. Мы не несем ответственности за любые недоразумения или неправильные толкования, возникшие в результате использования данного перевода.