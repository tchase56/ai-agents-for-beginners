<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "4a5ccc4ad1dba85fbc2087cf3b986544",
  "translation_date": "2025-08-29T19:55:53+00:00",
  "source_file": "04-tool-use/README.md",
  "language_code": "sw"
}
-->
[![Jinsi ya Kubuni Mawakala wa AI Wazuri](../../../translated_images/lesson-4-thumbnail.546162853cb3daffd64edd92014f274103f76360dfb39fc6e6ee399494da38fd.sw.png)](https://youtu.be/vieRiPRx-gI?si=cEZ8ApnT6Sus9rhn)

> _(Bofya picha hapo juu kutazama video ya somo hili)_

# Muundo wa Matumizi ya Zana

Zana ni za kuvutia kwa sababu zinawapa mawakala wa AI uwezo mpana zaidi. Badala ya wakala kuwa na seti ndogo ya vitendo anavyoweza kufanya, kwa kuongeza zana, wakala sasa anaweza kufanya vitendo mbalimbali. Katika sura hii, tutaangalia Muundo wa Matumizi ya Zana, ambao unaelezea jinsi mawakala wa AI wanavyoweza kutumia zana maalum kufanikisha malengo yao.

## Utangulizi

Katika somo hili, tunatafuta kujibu maswali yafuatayo:

- Muundo wa matumizi ya zana ni nini?
- Ni matukio gani ya matumizi yanayoweza kutumika?
- Ni vipengele gani vinavyohitajika kutekeleza muundo huu?
- Ni mambo gani maalum ya kuzingatia wakati wa kutumia Muundo wa Matumizi ya Zana kujenga mawakala wa AI wanaoaminika?

## Malengo ya Kujifunza

Baada ya kukamilisha somo hili, utaweza:

- Kufafanua Muundo wa Matumizi ya Zana na madhumuni yake.
- Kutambua matukio ya matumizi ambapo Muundo wa Matumizi ya Zana unafaa.
- Kuelewa vipengele muhimu vinavyohitajika kutekeleza muundo huu.
- Kutambua mambo ya kuzingatia ili kuhakikisha uaminifu wa mawakala wa AI wanaotumia muundo huu.

## Muundo wa Matumizi ya Zana ni nini?

**Muundo wa Matumizi ya Zana** unalenga kuwapa LLMs uwezo wa kuingiliana na zana za nje ili kufanikisha malengo maalum. Zana ni msimbo unaoweza kutekelezwa na wakala ili kufanya vitendo. Zana inaweza kuwa kazi rahisi kama kikokotoo, au API inayopiga huduma ya mtu wa tatu kama kutafuta bei za hisa au utabiri wa hali ya hewa. Katika muktadha wa mawakala wa AI, zana zimeundwa kutekelezwa na mawakala kwa kujibu **miito ya kazi iliyotengenezwa na modeli**.

## Ni matukio gani ya matumizi yanayoweza kutumika?

Mawakala wa AI wanaweza kutumia zana kukamilisha kazi ngumu, kupata taarifa, au kufanya maamuzi. Muundo wa matumizi ya zana mara nyingi hutumika katika hali zinazohitaji mwingiliano wa nguvu na mifumo ya nje, kama vile hifadhidata, huduma za wavuti, au wakalimani wa msimbo. Uwezo huu ni muhimu kwa matukio mbalimbali ya matumizi ikiwa ni pamoja na:

- **Upatikanaji wa Taarifa kwa Nguvu:** Mawakala wanaweza kuuliza API za nje au hifadhidata kupata data ya kisasa (mfano, kuuliza hifadhidata ya SQLite kwa uchambuzi wa data, kupata bei za hisa au taarifa za hali ya hewa).
- **Utekelezaji na Ufafanuzi wa Msimbo:** Mawakala wanaweza kutekeleza msimbo au maandiko kutatua matatizo ya kihisabati, kuzalisha ripoti, au kufanya majaribio.
- **Uendeshaji wa Mtiririko wa Kazi:** Kuendesha kazi za kurudia au za hatua nyingi kwa kuunganisha zana kama ratiba za kazi, huduma za barua pepe, au mifumo ya usindikaji wa data.
- **Msaada kwa Wateja:** Mawakala wanaweza kuingiliana na mifumo ya CRM, majukwaa ya tiketi, au hifadhidata za maarifa kujibu maswali ya watumiaji.
- **Uzalishaji na Uhariri wa Maudhui:** Mawakala wanaweza kutumia zana kama wakaguzi wa sarufi, muhtasari wa maandishi, au wakadiriaji wa usalama wa maudhui kusaidia kazi za uundaji wa maudhui.

## Ni vipengele gani vinavyohitajika kutekeleza muundo wa matumizi ya zana?

Vipengele hivi vinamwezesha wakala wa AI kufanya kazi mbalimbali. Hebu tuangalie vipengele muhimu vinavyohitajika kutekeleza Muundo wa Matumizi ya Zana:

- **Mifumo ya Kazi/Zana:** Maelezo ya kina ya zana zinazopatikana, ikiwa ni pamoja na jina la kazi, madhumuni, vigezo vinavyohitajika, na matokeo yanayotarajiwa. Mifumo hii inamwezesha LLM kuelewa zana zilizopo na jinsi ya kuunda maombi sahihi.
- **Mantiki ya Utekelezaji wa Kazi:** Inasimamia jinsi na lini zana zinavyotumika kulingana na nia ya mtumiaji na muktadha wa mazungumzo. Hii inaweza kujumuisha moduli za kupanga, mifumo ya kuelekeza, au mtiririko wa masharti unaoamua matumizi ya zana kwa nguvu.
- **Mfumo wa Kushughulikia Ujumbe:** Vipengele vinavyosimamia mtiririko wa mazungumzo kati ya maingizo ya mtumiaji, majibu ya LLM, miito ya zana, na matokeo ya zana.
- **Mfumo wa Ujumuishaji wa Zana:** Miundombinu inayounganisha wakala na zana mbalimbali, iwe ni kazi rahisi au huduma za nje ngumu.
- **Ushughulikiaji wa Makosa na Uthibitishaji:** Mifumo ya kushughulikia kushindwa kwa utekelezaji wa zana, kuthibitisha vigezo, na kudhibiti majibu yasiyotarajiwa.
- **Usimamizi wa Hali:** Huweka muktadha wa mazungumzo, mwingiliano wa zana za awali, na data ya kudumu ili kuhakikisha uthabiti katika mwingiliano wa hatua nyingi.

Sasa, hebu tuangalie kwa undani zaidi kuhusu Kuitwa kwa Kazi/Zana.

### Kuitwa kwa Kazi/Zana

Kuitwa kwa kazi ni njia kuu tunayotumia kuwezesha LLMs kuingiliana na zana. Mara nyingi utaona 'Kazi' na 'Zana' zikitumika kwa kubadilishana kwa sababu 'kazi' (vipande vya msimbo vinavyoweza kutumika tena) ni 'zana' ambazo mawakala hutumia kutekeleza kazi. Ili msimbo wa kazi utekelezwe, LLM lazima ilinganishe ombi la mtumiaji na maelezo ya kazi. Ili kufanya hivyo, mfumo unaoelezea kazi zote zinazopatikana hutumwa kwa LLM. LLM kisha huchagua kazi inayofaa zaidi kwa kazi hiyo na kurudisha jina lake na vigezo. Kazi iliyochaguliwa inatekelezwa, jibu lake linatumwa tena kwa LLM, ambayo hutumia taarifa hiyo kujibu ombi la mtumiaji.

Ili watengenezaji kutekeleza kuitwa kwa kazi kwa mawakala, utahitaji:

1. Mfano wa LLM unaounga mkono kuitwa kwa kazi
2. Mfumo unaoelezea kazi
3. Msimbo wa kila kazi iliyoelezewa

Hebu tuchukue mfano wa kupata muda wa sasa katika jiji fulani ili kufafanua:

1. **Anzisha LLM inayounga mkono kuitwa kwa kazi:**

    Si kila modeli inayoauni kuitwa kwa kazi, kwa hivyo ni muhimu kuhakikisha kuwa LLM unayotumia inafanya hivyo. <a href="https://learn.microsoft.com/azure/ai-services/openai/how-to/function-calling" target="_blank">Azure OpenAI</a> inaunga mkono kuitwa kwa kazi. Tunaweza kuanza kwa kuanzisha mteja wa Azure OpenAI.

    ```python
    # Initialize the Azure OpenAI client
    client = AzureOpenAI(
        azure_endpoint = os.getenv("AZURE_OPENAI_ENDPOINT"), 
        api_key=os.getenv("AZURE_OPENAI_API_KEY"),  
        api_version="2024-05-01-preview"
    )
    ```

1. **Unda Mfumo wa Kazi:**

    Kisha tutaelezea mfumo wa JSON unaojumuisha jina la kazi, maelezo ya kazi hiyo, na majina na maelezo ya vigezo vya kazi. Tutachukua mfumo huu na kuupitisha kwa mteja aliyeundwa hapo awali, pamoja na ombi la mtumiaji la kupata muda wa San Francisco. Jambo muhimu la kuzingatia ni kwamba kile kinachorudishwa ni **mwito wa zana**, **sio** jibu la mwisho la swali. Kama ilivyotajwa awali, LLM inarudisha jina la kazi iliyochaguliwa kwa kazi hiyo, na vigezo vitakavyopitishwa kwake.

    ```python
    # Function description for the model to read
    tools = [
        {
            "type": "function",
            "function": {
                "name": "get_current_time",
                "description": "Get the current time in a given location",
                "parameters": {
                    "type": "object",
                    "properties": {
                        "location": {
                            "type": "string",
                            "description": "The city name, e.g. San Francisco",
                        },
                    },
                    "required": ["location"],
                },
            }
        }
    ]
    ```
   
    ```python
  
    # Initial user message
    messages = [{"role": "user", "content": "What's the current time in San Francisco"}] 
  
    # First API call: Ask the model to use the function
      response = client.chat.completions.create(
          model=deployment_name,
          messages=messages,
          tools=tools,
          tool_choice="auto",
      )
  
      # Process the model's response
      response_message = response.choices[0].message
      messages.append(response_message)
  
      print("Model's response:")  

      print(response_message)
  
    ```

    ```bash
    Model's response:
    ChatCompletionMessage(content=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_pOsKdUlqvdyttYB67MOj434b', function=Function(arguments='{"location":"San Francisco"}', name='get_current_time'), type='function')])
    ```
  
1. **Msimbo wa kazi unaohitajika kutekeleza kazi:**

    Sasa kwa kuwa LLM imechagua kazi gani inahitaji kutekelezwa, msimbo unaotekeleza kazi hiyo unahitaji kuandikwa na kutekelezwa. Tunaweza kuandika msimbo wa kupata muda wa sasa kwa Python. Pia tutahitaji kuandika msimbo wa kutoa jina na vigezo kutoka kwa response_message ili kupata matokeo ya mwisho.

    ```python
      def get_current_time(location):
        """Get the current time for a given location"""
        print(f"get_current_time called with location: {location}")  
        location_lower = location.lower()
        
        for key, timezone in TIMEZONE_DATA.items():
            if key in location_lower:
                print(f"Timezone found for {key}")  
                current_time = datetime.now(ZoneInfo(timezone)).strftime("%I:%M %p")
                return json.dumps({
                    "location": location,
                    "current_time": current_time
                })
      
        print(f"No timezone data found for {location_lower}")  
        return json.dumps({"location": location, "current_time": "unknown"})
    ```

     ```python
     # Handle function calls
      if response_message.tool_calls:
          for tool_call in response_message.tool_calls:
              if tool_call.function.name == "get_current_time":
     
                  function_args = json.loads(tool_call.function.arguments)
     
                  time_response = get_current_time(
                      location=function_args.get("location")
                  )
     
                  messages.append({
                      "tool_call_id": tool_call.id,
                      "role": "tool",
                      "name": "get_current_time",
                      "content": time_response,
                  })
      else:
          print("No tool calls were made by the model.")  
  
      # Second API call: Get the final response from the model
      final_response = client.chat.completions.create(
          model=deployment_name,
          messages=messages,
      )
  
      return final_response.choices[0].message.content
     ```

     ```bash
      get_current_time called with location: San Francisco
      Timezone found for san francisco
      The current time in San Francisco is 09:24 AM.
     ```

Kuitwa kwa Kazi ni msingi wa muundo wa matumizi ya zana kwa mawakala, hata hivyo kutekeleza kutoka mwanzo kunaweza kuwa changamoto wakati mwingine. Kama tulivyojifunza katika [Somo la 2](../../../02-explore-agentic-frameworks), mifumo ya mawakala hutupatia vipengele vilivyojengwa tayari kutekeleza matumizi ya zana.

## Mifano ya Matumizi ya Zana na Mifumo ya Mawakala

Hapa kuna mifano ya jinsi unavyoweza kutekeleza Muundo wa Matumizi ya Zana kwa kutumia mifumo tofauti ya mawakala:

### Semantic Kernel

<a href="https://learn.microsoft.com/azure/ai-services/agents/overview" target="_blank">Semantic Kernel</a> ni mfumo wa AI wa chanzo huria kwa watengenezaji wa .NET, Python, na Java wanaofanya kazi na LLMs. Unarahisisha mchakato wa kutumia kuitwa kwa kazi kwa kuelezea moja kwa moja kazi zako na vigezo vyake kwa modeli kupitia mchakato unaoitwa <a href="https://learn.microsoft.com/semantic-kernel/concepts/ai-services/chat-completion/function-calling/?pivots=programming-language-python#1-serializing-the-functions" target="_blank">serialization</a>. Pia hushughulikia mawasiliano ya kurudi na kurudi kati ya modeli na msimbo wako. Faida nyingine ya kutumia mfumo wa mawakala kama Semantic Kernel ni kwamba hukuruhusu kufikia zana zilizojengwa tayari kama <a href="https://github.com/microsoft/semantic-kernel/blob/main/python/samples/getting_started_with_agents/openai_assistant/step4_assistant_tool_file_search.py" target="_blank">File Search</a> na <a href="https://github.com/microsoft/semantic-kernel/blob/main/python/samples/getting_started_with_agents/openai_assistant/step3_assistant_tool_code_interpreter.py" target="_blank">Code Interpreter</a>.

Mchoro ufuatao unaonyesha mchakato wa kuitwa kwa kazi na Semantic Kernel:

![function calling](../../../translated_images/functioncalling-diagram.a84006fc287f60140cc0a484ff399acd25f69553ea05186981ac4d5155f9c2f6.sw.png)

Katika Semantic Kernel kazi/zana huitwa <a href="https://learn.microsoft.com/semantic-kernel/concepts/plugins/?pivots=programming-language-python" target="_blank">Plugins</a>. Tunaweza kubadilisha kazi ya `get_current_time` tuliyoiona awali kuwa plugin kwa kuibadilisha kuwa darasa lenye kazi ndani yake. Tunaweza pia kuingiza kipambo cha `kernel_function`, ambacho kinachukua maelezo ya kazi. Unapounda kernel na GetCurrentTimePlugin, kernel itaserialize moja kwa moja kazi na vigezo vyake, ikitengeneza mfumo wa kutuma kwa LLM katika mchakato huo.

```python
from semantic_kernel.functions import kernel_function

class GetCurrentTimePlugin:
    async def __init__(self, location):
        self.location = location

    @kernel_function(
        description="Get the current time for a given location"
    )
    def get_current_time(location: str = ""):
        ...

```

```python 
from semantic_kernel import Kernel

# Create the kernel
kernel = Kernel()

# Create the plugin
get_current_time_plugin = GetCurrentTimePlugin(location)

# Add the plugin to the kernel
kernel.add_plugin(get_current_time_plugin)
```
  
### Huduma ya Mawakala ya Azure AI

<a href="https://learn.microsoft.com/azure/ai-services/agents/overview" target="_blank">Huduma ya Mawakala ya Azure AI</a> ni mfumo mpya wa mawakala ulioundwa kuwawezesha watengenezaji kujenga, kupeleka, na kupanua mawakala wa AI wa hali ya juu na wa kupanuka bila hitaji la kusimamia rasilimali za msingi za kompyuta na hifadhi. Ni muhimu hasa kwa matumizi ya biashara kwa kuwa ni huduma inayosimamiwa kikamilifu yenye usalama wa kiwango cha biashara.

Ikilinganishwa na kuendeleza moja kwa moja na API ya LLM, Huduma ya Mawakala ya Azure AI inatoa faida kadhaa, ikiwa ni pamoja na:

- Kuitwa kwa zana kiotomatiki – hakuna haja ya kuchanganua mwito wa zana, kuitisha zana, na kushughulikia majibu; yote haya sasa yanafanyika upande wa seva.
- Usimamizi wa data kwa usalama – badala ya kusimamia hali ya mazungumzo yako mwenyewe, unaweza kutegemea nyuzi kuhifadhi taarifa zote unazohitaji.
- Zana zilizojengwa tayari – Zana unazoweza kutumia kuingiliana na vyanzo vyako vya data, kama Bing, Azure AI Search, na Azure Functions.

Zana zinazopatikana katika Huduma ya Mawakala ya Azure AI zinaweza kugawanywa katika makundi mawili:

1. Zana za Maarifa:
    - <a href="https://learn.microsoft.com/azure/ai-services/agents/how-to/tools/bing-grounding?tabs=python&pivots=overview" target="_blank">Grounding na Bing Search</a>
    - <a href="https://learn.microsoft.com/azure/ai-services/agents/how-to/tools/file-search?tabs=python&pivots=overview" target="_blank">File Search</a>
    - <a href="https://learn.microsoft.com/azure/ai-services/agents/how-to/tools/azure-ai-search?tabs=azurecli%2Cpython&pivots=overview-azure-ai-search" target="_blank">Azure AI Search</a>

2. Zana za Vitendo:
    - <a href="https://learn.microsoft.com/azure/ai-services/agents/how-to/tools/function-calling?tabs=python&pivots=overview" target="_blank">Function Calling</a>
    - <a href="https://learn.microsoft.com/azure/ai-services/agents/how-to/tools/code-interpreter?tabs=python&pivots=overview" target="_blank">Code Interpreter</a>
    - <a href="https://learn.microsoft.com/azure/ai-services/agents/how-to/tools/openapi-spec?tabs=python&pivots=overview" target="_blank">Zana zilizofafanuliwa na OpenAI</a>
    - <a href="https://learn.microsoft.com/azure/ai-services/agents/how-to/tools/azure-functions?pivots=overview" target="_blank">Azure Functions</a>

Huduma ya Mawakala inatuwezesha kutumia zana hizi pamoja kama `toolset`. Pia hutumia `threads` ambazo hufuatilia historia ya ujumbe kutoka kwa mazungumzo fulani.

Fikiria wewe ni wakala wa mauzo katika kampuni inayoitwa Contoso. Unataka kuunda wakala wa mazungumzo anayeweza kujibu maswali kuhusu data yako ya mauzo.

Picha ifuatayo inaonyesha jinsi unavyoweza kutumia Huduma ya Mawakala ya Azure AI kuchambua data yako ya mauzo:

![Agentic Service In Action](../../../translated_images/agent-service-in-action.34fb465c9a84659edd3003f8cb62d6b366b310a09b37c44e32535021fbb5c93f.sw.jpg)

Ili kutumia zana yoyote na huduma hii, tunaweza kuunda mteja na kufafanua zana au seti ya zana. Ili kutekeleza hili kwa vitendo, tunaweza kutumia msimbo wa Python ufuatao. LLM itaweza kuangalia seti ya zana na kuamua kutumia kazi iliyoundwa na mtumiaji, `fetch_sales_data_using_sqlite_query`, au Code Interpreter iliyojengwa tayari kulingana na ombi la mtumiaji.

```python 
import os
from azure.ai.projects import AIProjectClient
from azure.identity import DefaultAzureCredential
from fetch_sales_data_functions import fetch_sales_data_using_sqlite_query # fetch_sales_data_using_sqlite_query function which can be found in a fetch_sales_data_functions.py file.
from azure.ai.projects.models import ToolSet, FunctionTool, CodeInterpreterTool

project_client = AIProjectClient.from_connection_string(
    credential=DefaultAzureCredential(),
    conn_str=os.environ["PROJECT_CONNECTION_STRING"],
)

# Initialize function calling agent with the fetch_sales_data_using_sqlite_query function and adding it to the toolset
fetch_data_function = FunctionTool(fetch_sales_data_using_sqlite_query)
toolset = ToolSet()
toolset.add(fetch_data_function)

# Initialize Code Interpreter tool and adding it to the toolset. 
code_interpreter = code_interpreter = CodeInterpreterTool()
toolset = ToolSet()
toolset.add(code_interpreter)

agent = project_client.agents.create_agent(
    model="gpt-4o-mini", name="my-agent", instructions="You are helpful agent", 
    toolset=toolset
)
```

## Ni mambo gani maalum ya kuzingatia wakati wa kutumia Muundo wa Matumizi ya Zana kujenga mawakala wa AI wanaoaminika?

Shida ya kawaida na SQL inayotengenezwa kwa nguvu na LLMs ni usalama, hasa hatari ya sindano ya SQL au vitendo vya uharibifu, kama kufuta au kuharibu hifadhidata. Ingawa wasiwasi huu ni halali, unaweza kupunguzwa kwa ufanisi kwa kusanidi vibali vya ufikiaji wa hifadhidata ipasavyo. Kwa hifadhidata nyingi, hii inahusisha kusanidi hifadhidata kama ya kusoma tu. Kwa huduma za hifadhidata kama PostgreSQL au Azure SQL, programu inapaswa kupewa jukumu la kusoma tu (SELECT).

Kuendesha programu katika mazingira salama kunaboresha zaidi ulinzi. Katika hali za biashara, data kawaida hutolewa na kubadilishwa kutoka kwa mifumo ya uendeshaji hadi hifadhidata ya kusoma tu au ghala la data lenye mpangilio wa kirafiki. Njia hii inahakikisha kuwa data ni salama, imeboreshwa kwa utendaji na ufikivu, na kwamba programu ina ufikiaji mdogo wa kusoma tu.

### Una Maswali Zaidi Kuhusu Muundo wa Matumizi ya Zana?
Jiunge na [Azure AI Foundry Discord](https://aka.ms/ai-agents/discord) ili kukutana na wanafunzi wengine, kuhudhuria saa za ofisi, na kupata majibu ya maswali yako kuhusu AI Agents.

## Rasilimali za Ziada

## Somo Lililopita

[Kuelewa Miundo ya Ubunifu wa Kiumbe](../03-agentic-design-patterns/README.md)

## Somo Linalofuata

[Agentic RAG](../05-agentic-rag/README.md)

---

**Kanusho**:  
Hati hii imetafsiriwa kwa kutumia huduma ya kutafsiri ya AI [Co-op Translator](https://github.com/Azure/co-op-translator). Ingawa tunajitahidi kuhakikisha usahihi, tafadhali fahamu kuwa tafsiri za kiotomatiki zinaweza kuwa na makosa au kutokuwa sahihi. Hati ya asili katika lugha yake ya awali inapaswa kuzingatiwa kama chanzo cha mamlaka. Kwa taarifa muhimu, tafsiri ya kitaalamu ya binadamu inapendekezwa. Hatutawajibika kwa kutoelewana au tafsiri zisizo sahihi zinazotokana na matumizi ya tafsiri hii.